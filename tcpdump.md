## üîπ 1. **–ë–∞–∑–æ–≤—ã–µ –∫–æ–º–∞–Ω–¥—ã**

| –ö–æ–º–∞–Ω–¥–∞ | –û–ø–∏—Å–∞–Ω–∏–µ |
|--------|--------|
| `tcpdump -i eth0` | –°–Ω–∏—Ñ—Ñ–∏–Ω–≥ —Ç—Ä–∞—Ñ–∏–∫–∞ –Ω–∞ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–µ `eth0` |
| `tcpdump -i any` | –°–Ω–∏—Ñ—Ñ–∏–Ω–≥ –Ω–∞ –≤—Å–µ—Ö –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞—Ö |
| `tcpdump -i lo` | –°–Ω–∏—Ñ—Ñ–∏–Ω–≥ –Ω–∞ loopback (–≤–∞–∂–Ω–æ: –º–æ–∂–µ—Ç –Ω–µ —Ä–∞–±–æ—Ç–∞—Ç—å –Ω–∞ `lo` –±–µ–∑ `-p`) |
| `tcpdump -c 10` | –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –ø–æ—Å–ª–µ 10 –ø–∞–∫–µ—Ç–æ–≤ |
| `tcpdump -n` | –ù–µ —Ä–∞–∑—Ä–µ—à–∞—Ç—å IP –∏ –ø–æ—Ä—Ç—ã –≤ –∏–º–µ–Ω–∞ (–±—ã—Å—Ç—Ä–µ–µ, –±–µ–∑ DNS) |
| `tcpdump -nn` | –ë–µ–∑ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è IP –∏ –ø–æ—Ä—Ç–æ–≤ (–ø–æ—Ä—Ç –∫–∞–∫ —á–∏—Å–ª–æ, –Ω–µ –∫–∞–∫ `http`) |
| `tcpdump -v` | –ü–æ–¥—Ä–æ–±–Ω—ã–π –≤—ã–≤–æ–¥ (–º–æ–∂–Ω–æ `-vv`, `-vvv`) |
| `tcpdump -q` | –ö—Ä–∞—Ç–∫–∏–π (quiet) –≤—ã–≤–æ–¥ |
| `tcpdump -X` | –ü–æ–∫–∞–∑–∞—Ç—å –ø–∞–∫–µ—Ç –≤ hex –∏ ASCII |
| `tcpdump -XX` | –¢–æ –∂–µ, –Ω–æ —Å –∑–∞–≥–æ–ª–æ–≤–∫–∞–º–∏ Ethernet |
| `tcpdump -s 0` | –ó–∞—Ö–≤–∞—Ç—ã–≤–∞—Ç—å –ø–æ–ª–Ω—ã–π —Ä–∞–∑–º–µ—Ä –ø–∞–∫–µ—Ç–∞ (snaplen = 65535) |

> üí° `-s 0` –∏–ª–∏ `-s 1500` ‚Äî –≤–∞–∂–Ω–æ, –µ—Å–ª–∏ –Ω—É–∂–Ω–æ –≤–∏–¥–µ—Ç—å **–≤–µ—Å—å payload**, –∞ –Ω–µ –æ–±—Ä–µ–∑–∞–Ω–Ω—ã–µ –∫—É—Å–∫–∏.

---

## üîπ 2. **–§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ —Å–µ—Ç–µ–≤—ã–º –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º**

| –§–∏–ª—å—Ç—Ä | –û–ø–∏—Å–∞–Ω–∏–µ |
|--------|--------|
| `tcpdump host 192.168.1.10` | –¢–æ–ª—å–∫–æ —Ç—Ä–∞—Ñ–∏–∫ —Å/–Ω–∞ IP |
| `tcpdump src 192.168.1.10` | –¢–æ–ª—å–∫–æ –∏—Å—Ö–æ–¥—è—â–∏–π –æ—Ç IP |
| `tcpdump dst 192.168.1.10` | –¢–æ–ª—å–∫–æ –≤—Ö–æ–¥—è—â–∏–π –∫ IP |
| `tcpdump net 192.168.1.0/24` | –¢—Ä–∞—Ñ–∏–∫ –≤ —Å–µ—Ç–∏ |
| `tcpdump net 192.168.1.0 mask 255.255.255.0` | –° –º–∞—Å–∫–æ–π (—Å—Ç–∞—Ä—ã–π —Å–∏–Ω—Ç–∞–∫—Å–∏—Å) |

---

## üîπ 3. **–§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ –ø—Ä–æ—Ç–æ–∫–æ–ª–∞–º**

| –§–∏–ª—å—Ç—Ä | –û–ø–∏—Å–∞–Ω–∏–µ |
|--------|--------|
| `tcpdump tcp` | –¢–æ–ª—å–∫–æ TCP |
| `tcpdump udp` | –¢–æ–ª—å–∫–æ UDP |
| `tcpdump icmp` | –¢–æ–ª—å–∫–æ ICMP (ping) |
| `tcpdump arp` | –¢–æ–ª—å–∫–æ ARP-–∑–∞–ø—Ä–æ—Å—ã |
| `tcpdump ip6` | –¢–æ–ª—å–∫–æ IPv6 |
| `tcpdump port 80` | –¢–æ–ª—å–∫–æ —Ç—Ä–∞—Ñ–∏–∫ –Ω–∞/—Å –ø–æ—Ä—Ç–∞ 80 |
| `tcpdump src port 53` | –ò—Å—Ö–æ–¥—è—â–∏–π —Å –ø–æ—Ä—Ç–∞ 53 (DNS) |
| `tcpdump dst port 443` | –ù–∞–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–π –Ω–∞ –ø–æ—Ä—Ç 443 |
| `tcpdump portrange 8000-9000` | –í –¥–∏–∞–ø–∞–∑–æ–Ω–µ –ø–æ—Ä—Ç–æ–≤ |

---

## üîπ 4. **–ö–æ–º–±–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Ñ–∏–ª—å—Ç—Ä—ã (–ª–æ–≥–∏—á–µ—Å–∫–∏–µ –æ–ø–µ—Ä–∞—Ç–æ—Ä—ã)**

| –§–∏–ª—å—Ç—Ä | –û–ø–∏—Å–∞–Ω–∏–µ |
|--------|--------|
| `tcpdump tcp and port 80` | TCP –∏ –ø–æ—Ä—Ç 80 |
| `tcpdump host 192.168.1.10 and not ssh` | –û—Ç/–∫ IP, –∫—Ä–æ–º–µ SSH |
| `tcpdump src 192.168.1.10 and dst port 443` | –û—Ç IP –∫ –ø–æ—Ä—Ç—É 443 |
| `tcpdump udp or icmp` | UDP –∏–ª–∏ ICMP |
| `tcpdump '(tcp port 80) and (host 10.0.0.5)'` | –°–∫–æ–±–∫–∏ –≥—Ä—É–ø–ø–∏—Ä—É—é—Ç —É—Å–ª–æ–≤–∏—è |
| `tcpdump -Q in` | –¢–æ–ª—å–∫–æ –≤—Ö–æ–¥—è—â–∏–π —Ç—Ä–∞—Ñ–∏–∫ (–µ—Å–ª–∏ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è) |
| `tcpdump -Q out` | –¢–æ–ª—å–∫–æ –∏—Å—Ö–æ–¥—è—â–∏–π |

> ‚ö†Ô∏è –ü—Ä–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏ `and`, `or`, `not` ‚Äî –ª—É—á—à–µ –±—Ä–∞—Ç—å —Ñ–∏–ª—å—Ç—Ä –≤ **–∫–∞–≤—ã—á–∫–∏**, —á—Ç–æ–±—ã –æ–±–æ–π—Ç–∏ shell.

---

## üîπ 5. **–§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ —Ç–∏–ø—É TCP-—Ñ–ª–∞–≥–æ–≤**

| –§–∏–ª—å—Ç—Ä | –û–ø–∏—Å–∞–Ω–∏–µ |
|--------|--------|
| `tcpdump 'tcp[tcpflags] == tcp-syn'` | –¢–æ–ª—å–∫–æ SYN-–ø–∞–∫–µ—Ç—ã |
| `tcpdump 'tcp[tcpflags] & tcp-syn != 0'` | –õ—é–±–æ–π –ø–∞–∫–µ—Ç —Å —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã–º SYN |
| `tcpdump 'tcp[tcpflags] == tcp-rst'` | –¢–æ–ª—å–∫–æ RST |
| `tcpdump 'tcp[tcpflags] & tcp-ack == 0'` | –ü–∞–∫–µ—Ç—ã –±–µ–∑ ACK (–Ω–∞–ø—Ä–∏–º–µ—Ä, SYN) |
| `tcpdump 'tcp[tcpflags] & (tcp-syn|tcp-fin|tcp-rst) != 0'` | SYN, FIN –∏–ª–∏ RST (—É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ–º) |

---

## üîπ 6. **–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∏ —á—Ç–µ–Ω–∏–µ –¥–∞–º–ø–æ–≤**

| –ö–æ–º–∞–Ω–¥–∞ | –û–ø–∏—Å–∞–Ω–∏–µ |
|--------|--------|
| `tcpdump -w capture.pcap` | –ó–∞–ø–∏—Å–∞—Ç—å –≤ —Ñ–∞–π–ª (–±–∏–Ω–∞—Ä–Ω—ã–π pcap) |
| `tcpdump -r capture.pcap` | –ü—Ä–æ—á–∏—Ç–∞—Ç—å –∏–∑ —Ñ–∞–π–ª–∞ |
| `tcpdump -r capture.pcap port 80` | –ß–∏—Ç–∞—Ç—å –∏ —Ñ–∏–ª—å—Ç—Ä–æ–≤–∞—Ç—å –¥–∞–º–ø |
| `tcpdump -w - \| gzip > capture.pcap.gz` | –ó–∞–ø–∏—Å—å —Å –∫–æ–º–ø—Ä–µ—Å—Å–∏–µ–π |
| `gunzip -c capture.pcap.gz \| tcpdump -r -` | –ß—Ç–µ–Ω–∏–µ —Å–∂–∞—Ç–æ–≥–æ –¥–∞–º–ø–∞ |

---

## üîπ 7. **–ü–æ–ª–µ–∑–Ω—ã–µ –∫–æ–º–±–∏–Ω–∞—Ü–∏–∏ (—Ä–µ–∞–ª—å–Ω—ã–µ –ø—Ä–∏–º–µ—Ä—ã)**

| –ó–∞–¥–∞—á–∞ | –ö–æ–º–∞–Ω–¥–∞ |
|-------|--------|
| **HTTP-—Ç—Ä–∞—Ñ–∏–∫** | `tcpdump -i eth0 -nn -s 0 -v port 80` |
| **HTTPS (TLS)** | `tcpdump -i eth0 -nn -s 0 port 443` |
| **DNS-–∑–∞–ø—Ä–æ—Å—ã** | `tcpdump -i eth0 -nn port 53` |
| **–ü–∏–Ω–≥–∏ (ICMP)** | `tcpdump -i eth0 icmp` |
| **TCP handshake (SYN)** | `tcpdump 'tcp[tcpflags] & tcp-syn != 0'` |
| **–ù–∞–π—Ç–∏ —Å–∫–∞–Ω–µ—Ä –ø–æ—Ä—Ç–æ–≤** | `tcpdump 'tcp[tcpflags] == tcp-syn' and 'tcp[13] == 2'` (SYN –±–µ–∑ ACK) |
| **–¢—Ä–∞—Ñ–∏–∫ –∫ –æ–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω–æ–º—É —Å–µ—Ä–≤–µ—Ä—É** | `tcpdump host api.example.com and port 443` |
| **–í–µ—Å—å —Ç—Ä–∞—Ñ–∏–∫, –∫—Ä–æ–º–µ SSH** | `tcpdump not port 22` |
| **–¢–æ–ª—å–∫–æ broadcast/ARP** | `tcpdump ether broadcast or arp` |

---

## üîπ 8. **–ü—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–µ –æ–ø—Ü–∏–∏**

| –û–ø—Ü–∏—è | –û–ø–∏—Å–∞–Ω–∏–µ |
|------|--------|
| `tcpdump -e` | –ü–æ–∫–∞–∑—ã–≤–∞—Ç—å Ethernet-–∑–∞–≥–æ–ª–æ–≤–∫–∏ (MAC-–∞–¥—Ä–µ—Å–∞) |
| `tcpdump -E secret` | –†–∞—Å—à–∏—Ñ—Ä–æ–≤–∫–∞ IPsec (—É—Å—Ç–∞—Ä–µ–ª–æ, –ª—É—á—à–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `tcpflow` –∏–ª–∏ Wireshark) |
| `tcpdump -A` | –ü–æ–∫–∞–∑–∞—Ç—å –¥–∞–Ω–Ω—ã–µ –≤ ASCII (–¥–ª—è —Ç–µ–∫—Å—Ç–∞, –Ω–∞–ø—Ä–∏–º–µ—Ä HTTP) |
| `tcpdump -x` | –î–∞–Ω–Ω—ã–µ –≤ hex (–±–µ–∑ –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤) |
| `tcpdump -D` | –ü–æ–∫–∞–∑–∞—Ç—å –≤—Å–µ –¥–æ—Å—Ç—É–ø–Ω—ã–µ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã |
| `tcpdump -l` | Line-buffered –≤—ã–≤–æ–¥ (–ø–æ–ª–µ–∑–Ω–æ –ø—Ä–∏ –ø–∞–π–ø–µ –≤ `grep`) |
| `tcpdump -t` | –£–±—Ä–∞—Ç—å –≤—Ä–µ–º–µ–Ω–Ω—ã–µ –º–µ—Ç–∫–∏ |
| `tcpdump -tttt` | –ü–æ–ª–Ω–∞—è –¥–∞—Ç–∞ –∏ –≤—Ä–µ–º—è (—á–µ–ª–æ–≤–µ–∫–æ—á–∏—Ç–∞–µ–º–æ) |

–ü—Ä–∏–º–µ—Ä:
```bash
tcpdump -i eth0 -l port 80 | grep "GET"
```
‚Äî –ø–æ–∑–≤–æ–ª—è–µ—Ç —Ñ–∏–ª—å—Ç—Ä–æ–≤–∞—Ç—å HTTP-–∑–∞–ø—Ä–æ—Å—ã –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏.

---

## üîπ 9. **–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ —Ä–∞–∑–º–µ—Ä–∞ –∏ –≤—Ä–µ–º–µ–Ω–∏**

| –û–ø—Ü–∏—è | –û–ø–∏—Å–∞–Ω–∏–µ |
|------|--------|
| `tcpdump -c 100 -w dump.pcap` | 100 –ø–∞–∫–µ—Ç–æ–≤ –≤ —Ñ–∞–π–ª |
| `timeout 30 tcpdump -w temp.pcap` | –ó–∞–ø–∏—Å—å 30 —Å–µ–∫—É–Ω–¥ |
| `tcpdump -G 60 -w file-%S.pcap` | –†–æ—Ç–∞—Ü–∏—è —Ñ–∞–π–ª–∞ –∫–∞–∂–¥—ã–µ 60 —Å–µ–∫—É–Ω–¥ |
| `tcpdump -C 1 -w bigfile.pcap` | –ù–æ–≤—ã–π —Ñ–∞–π–ª –ø—Ä–∏ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–∏ ~1MB |

---

## üîπ 10. **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –∏ —Å–æ–≤–µ—Ç—ã**

- –ó–∞–ø—É—Å–∫–∞–π—Ç–µ `tcpdump` —Å `sudo` –∏–ª–∏ –¥–∞–π—Ç–µ CAP_NET_RAW:
  ```bash
  sudo setcap cap_net_raw+ep /usr/sbin/tcpdump
  ```
- –ù–µ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ `tcpdump` –Ω–∞ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ –±–µ–∑ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ ‚Äî –º–æ–∂–µ—Ç "–∑–∞–¥—É—à–∏—Ç—å" —Å–∏—Å—Ç–µ–º—É.
- –î–ª—è –∞–Ω–∞–ª–∏–∑–∞ pcap-—Ñ–∞–π–ª–æ–≤ –ª—É—á—à–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å **Wireshark**, **tshark**, **tcpflow**.
- –ò–∑–±–µ–≥–∞–π—Ç–µ `tcpdump -i any` –ø—Ä–∏ –∞–Ω–∞–ª–∏–∑–µ ‚Äî –º–æ–∂–µ—Ç –¥—É–±–ª–∏—Ä–æ–≤–∞—Ç—å –ø–∞–∫–µ—Ç—ã.

---

## üìå –ü—Ä–∏–º–µ—Ä: –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è

```bash
# –°–º–æ—Ç—Ä–∏–º, –∏–¥—ë—Ç –ª–∏ SYN –∫ –≤–µ–±-—Å–µ—Ä–≤–µ—Ä—É
tcpdump -i eth0 -nn 'tcp port 80 and (tcp-syn or tcp-ack or tcp-rst)'
```

–ï—Å–ª–∏ –≤–∏–¥–∏—Ç–µ `SYN`, –Ω–æ –Ω–µ—Ç `SYN-ACK` ‚Äî –ø—Ä–æ–±–ª–µ–º–∞ –Ω–∞ —Å—Ç–æ—Ä–æ–Ω–µ —Å–µ—Ä–≤–µ—Ä–∞ –∏–ª–∏ –≤ —Å–µ—Ç–∏.

---

## üß∞ –ü–æ–ª–µ–∑–Ω—ã–µ –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤—ã
- `tshark` ‚Äî CLI-–≤–µ—Ä—Å–∏—è Wireshark, –º–æ—â–Ω–µ–µ, –Ω–æ —Å–ª–æ–∂–Ω–µ–µ.
- `wireshark` ‚Äî GUI, –¥–ª—è –≥–ª—É–±–æ–∫–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞.
- `ngrep` ‚Äî –∫–∞–∫ `grep`, –Ω–æ –ø–æ —Å–µ—Ç–µ–≤–æ–º—É —Ç—Ä–∞—Ñ–∏–∫—É.
- `tcpflow` ‚Äî –≤–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç –ø–æ—Ç–æ–∫–∏ –¥–∞–Ω–Ω—ã—Ö –∏–∑ pcap.
